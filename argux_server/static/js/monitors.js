$(function(){function t(t){$("#objects").empty(),$.each(t.monitors,function(t,s){options="",$.each(s.options,function(t,s){options+='<li><span style="font-weight: bold">'+t+":</span> "+s+"</li>"}),s.active?(button='<span class="glyphicon glyphicon-pause"></span>',state="running",klass=""):(button='<span class="glyphicon glyphicon-play"></span>',state="paused",klass="pause"),$("#objects").append('<tr class="'+klass+'" data-hostname="'+s.host+'" data-address="'+s.address+'" ><td><a href="#" class="monitor-play-btn">'+button+'</a><a href="'+ARGUX_BASE+"/monitor/"+ARGUX_MONITOR_TYPE+"/"+s.host+"/"+s.address+'/edit">'+s.host+" ("+s.address+")</a></td><td><ul>"+options+'</ul></td><td class="state">'+state+'</td><td><div class="pull-right"><a href="#" class="monitor-remove"><span class="glyphicon glyphicon-trash"></span></a></div></td></tr>')}),$(".monitor-play-btn").click(function(){var t=$(this),s=t.parents("tr"),a=s.data("hostname"),o=s.data("address"),e=s.children("td.state"),n=s.hasClass("pause");data={options:{interval:60}},n===!0?(data.active="true",rest.call({url:ARGUX_BASE+"/rest/1.0/monitor/"+ARGUX_MONITOR_TYPE+"/"+a+"/"+o,type:rest.CallType.CREATE,data:data,success:function(){s.removeClass("pause"),t.children().removeClass("glyphicon-play"),t.children().addClass("glyphicon-pause"),e.text("running")}})):(data.active="false",rest.call({url:ARGUX_BASE+"/rest/1.0/monitor/"+ARGUX_MONITOR_TYPE+"/"+a+"/"+o,type:rest.CallType.CREATE,data:data,success:function(){s.addClass("pause"),t.children().addClass("glyphicon-play"),t.children().removeClass("glyphicon-pause"),e.text("paused")}}))}),$(".monitor-remove").click(function(){var t=$(this).parents("tr").data("hostname"),s=$(this).parents("tr").data("address");$("#dmcm-hostname").val(t),$("#dmcm-address").val(s),$("#dmcm-message").text("Do you want to remove the "+ARGUX_MONITOR_TYPE+" monitor for "+t+" on "+s),$("#dmcm").modal("show")})}function s(){setTimeout(monitors.get_monitors,6e4,{complete_callback:s,type:ARGUX_MONITOR_TYPE})}function a(t){$("#monitor-address").empty(),0==t.addresses.length?$("#monitor-address").append("<option disabled>No addresses</option>"):$.each(t.addresses,function(t,s){""!=s.description?$("#monitor-address").append('<option value="'+s.name+'">'+s.name+" ("+s.description+")</option>"):$("#monitor-address").append('<option value="'+s.name+'">'+s.name+"</option>")})}var o=$("#monitor-host").val();monitors.get_monitors({complete:s,success:t,type:ARGUX_MONITOR_TYPE}),host.get_addresses({hostname:o,success:a}),$("#new-object-form").submit(function(t){var s=$("#monitor-running").is(":checked");monitors.create({hostname:$("#monitor-host").val(),address:$("#monitor-address").val(),active:s,options:{interval:$("#monitor-interval").val()}}),$("#create-monitor-modal").modal("hide"),monitors.get_monitors({type:ARGUX_MONITOR_TYPE})}),$("#monitor-delete-form").submit(function(t){monitors.remove({hostname:$("#dmcm-hostname").val(),address:$("#dmcm-address").val()}),$("#dmcm").modal("hide"),monitors.get_monitors({type:ARGUX_MONITOR_TYPE})}),$("#monitor-host").on("change",function(t){host.get_addresses({hostname:this.value,success:a})})});
