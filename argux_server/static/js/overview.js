var ctx=null,overviewChart=null;$(function(){function t(t){$("#objects").empty(),$("#source-groups").empty(),t.groups=t.groups.sort(function(t,e){return t.name>=e.name}),$.each(t.groups,function(t,e){var s=e.total-e.warning-e.critical;0===e.total?(okay_class="",warning_class="",critical_class=""):(s>0?okay_class="success":okay_class="",e.warning>0?warning_class="warning":warning_class="success",e.critical>0?critical_class="danger":critical_class="success"),$("#objects").append('<tr><td><a href="'+ARGUX_BASE+"/hosts/groups/"+e.name+'">'+e.name+'</a></td><td class="'+okay_class+'">'+s+'</td><td class="'+warning_class+'">'+e.warning+'</td><td class="'+critical_class+'">'+e.critical+"</td></tr>"),"All"!==e.name&&$("#source-groups").append($("<option></option>").attr("value",e.name).text(e.name))})}function e(t){var e=0,s=[0,0,0,0];$("#objects").empty(),t.hosts=t.hosts.sort(function(t,e){return t.name>=e.name}),$.each(t.hosts,function(t,a){$("#objects").append('<tr><td><a href="'+ARGUX_BASE+"/host/"+a.name+'">'+a.name+'</a></td><td><a href="'+ARGUX_BASE+"/host/"+a.name+'/metrics">'+a.n_items+'</a></td><td><a href="'+ARGUX_BASE+"/host/"+a.name+'/alerts">'+a.active_alerts+"</a></td></tr>"),"crit"===a.severity?s[2]+=1:"warn"===a.severity?s[1]+=1:"info"===a.severity?s[3]+=1:s[0]+=1,e+=a.active_alerts}),host_overview_chart_config.data.datasets[0].data=s,e>0?$("#alert_count").text(e):$("#alert_count").text(""),overviewChart.update()}function s(t,e,s){if(201!==t.status){var a=$(".modal-form-alerts");a.empty(),a.append('<div class="alert alert-danger alert-dismissible"><strong>Problem:</strong> '+t.responseJSON.message)}else $("#create-host-modal").modal("hide"),host.get_host_overview({complete_callback:get_host_complete_callback})}function a(){setTimeout(host.get_host_overview,1e4,{success:e,complete:a})}"overview"===ARGUX_ACTION&&(ctx=document.getElementById("overview").getContext("2d"),overviewChart=new Chart(ctx,host_overview_chart_config),host.get_host_overview({success:e,complete:a})),"groups"===ARGUX_ACTION&&(host.get_groups({success:t}),$("#add-group").click(function(t){t.preventDefault(),$("#source-groups option:selected").each(function(){$("#dst-groups").append(this)})}),$("#remove-group").click(function(t){t.preventDefault(),$("#dst-groups option:selected").each(function(){$("#source-groups").append(this)})}),$("#new-host-form").submit(function(t){t.preventDefault(),groups=[],$("#dst-groups option:selected").each(function(){groups.push(this.value)}),host.create({hostname:$("#host-name").val(),description:$("#host-description").val(),groups:groups,error:s})}))});
